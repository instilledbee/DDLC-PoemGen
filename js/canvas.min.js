"use strict"
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n]
a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),PoemCanvas=function(){function e(){_classCallCheck(this,e),this.styles=[{"class":"monika",font:"15.5pt Journal",paper:"poem.jpg",maxLength:147,lineHeight:20},{"class":"natsuki",font:"15pt Ammys Handwriting",paper:"poem.jpg",maxLength:82,lineHeight:23},{"class":"yuri1",font:"16.25pt JP Hand Slanted",paper:"poem.jpg",maxLength:133,lineHeight:22},{"class":"yuri2",font:"16.5pt As I Lay Dying",paper:"poem_y1.jpg",maxLength:168,lineHeight:22},{"class":"special",font:"15.5pt A Typewriter For Me",paper:"poem.jpg",maxLength:63,lineHeight:21},{"class":"yuri3",font:"16.75pt Damagrafik Script",paper:"poem_y2.jpg",maxLength:30,lineHeight:19},{"class":"sayori",font:"18.75pt Hashtag",paper:"poem.jpg",maxLength:104,lineHeight:22}],this.canvasIDName="poemImg",this.preLoadCanvasFonts()}return _createClass(e,[{key:"preLoadCanvasFonts",value:function(){for(var e=document.getElementById(this.canvasIDName).getContext("2d"),t=0;t<this.styles.length;t++)e.fillText("Sample",250,50),e.font=this.styles[t].font}},{key:"createDownload",value:function(e){var t=document.getElementById(this.canvasIDName)
if(t.getContext)if(Math.random()>=this.styles.length/100){var n="img/"+this.currStyle.paper,a=this.currStyle.font,r=this.currStyle.lineHeight
e=this.chunkString(e)
var o=t.getContext("2d")
o.clearRect(0,0,1280,720)
var i=new Image
i.onload=function(){o.drawImage(i,0,0)
var s=new Image
s.onload=function(){o.drawImage(s,240,0),o.font=a
for(var n=0;n<e.length;++n)o.fillText(e[n],265,50+r*n,1280)
var i=t.toDataURL("image/png"),l=document.createElement("a")
l.download="poem.png",l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l)},s.src=n},i.src="img/club.png"}else{var n="img/bxstgrxll.jpg",s=new Image,o=t.getContext("2d")
o.clearRect(0,0,1280,720),s.onload=function(){o.drawImage(s,128,0)
var e=t.toDataURL("image/png"),n=document.createElement("a")
n.download="poem.png",n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)},s.src=n}else alert("Sorry, your browser doesn't support image generation!")}},{key:"chunkString",value:function(e){for(var t=e.match(RegExp("(.|[\r\n]){1,"+this.currStyle.maxLength+"}","g")),n=0;n<t.length;++n)t[n]+="\r\n"
return t}},{key:"canvasID",get:function(){return this.canvasIDName},set:function(e){this.canvasIDName=e}},{key:"style",get:function(){return this.currStyle},set:function(e){for(var t=0;t<this.styles.length;t++)if(this.styles[t]["class"]===e)return void(this.currStyle=this.styles[t])}}]),e}()